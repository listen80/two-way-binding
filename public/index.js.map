{"version":3,"file":"index.js","sources":["../src/directives/DirectiveUtils.js","../src/events/EventBinder.js","../src/directives/DirectiveHandler.js","../src/reactivity/Dep.js","../src/reactivity/Watcher.js","../src/utils/Updater.js","../src/nodes/NodeCompiler.js","../src/core/Compile.js","../src/core/Observe.js","../src/nodes/htmlParse.js","../src/utils/get.js","../src/core/Binding.js"],"sourcesContent":["\r\n/**\r\n * 判断属性是否为数据指令\r\n * @param {string} attr - 属性名\r\n * @returns {boolean} - 是否为数据指令\r\n */\r\nexport function isAttributDirective(attr) {\r\n    return attr.indexOf(':') === 0;\r\n}\r\n\r\n/**\r\n * 判断属性是否为自定义指令\r\n * @param {string} attr - 属性名\r\n * @returns {boolean} - 是否为自定义指令\r\n */\r\nexport function isDirective(attr) {\r\n    return attr.indexOf('$') === 0;\r\n}\r\n\r\n/**\r\n * 判断属性是否为事件指令\r\n * @param {string} attr - 属性名\r\n * @returns {boolean} - 是否为事件指令\r\n */\r\nexport function isEventDirective(attr) {\r\n    return attr.indexOf('@') === 0;\r\n}\r\n\r\n","/**\r\n * 处理事件指令，为元素添加事件监听器\r\n * @param {HTMLElement} node - 要添加事件监听器的元素节点\r\n * @param {object} vm - 视图模型实例\r\n * @param {string} exp - 方法名\r\n * @param {string} dir - 事件类型\r\n */\r\nexport function eventHandler(node, vm, exp, dir, methods) {\r\n    const fn = methods[exp];\r\n    if (fn && dir) {\r\n        node.addEventListener(dir, fn.bind(vm));\r\n    }\r\n}","\r\n/**\r\n * 处理 `model` 指令，实现双向数据绑定\r\n * @param {HTMLInputElement|HTMLSelectElement|HTMLTextAreaElement} node - 要处理的表单元素\r\n * @param {object} vm - 视图模型实例\r\n * @param {string} exp - 表达式\r\n */\r\n// 定义特殊输入类型的数组，这些类型在处理 model 指令时会有特定逻辑\r\nconst specialTypes = [\r\n    'checkbox', 'radio', 'select-one'\r\n];\r\n\r\nconst inputTypes = [\r\n    'text', 'password', 'email', 'tel', 'url', 'number', 'range', 'date', 'datetime-local', 'month', 'week', 'time', 'color', 'search', 'image', 'textarea',\r\n    'select-multiple', 'select-one', 'select'\r\n]\r\n\r\nexport const directiveHandler = (node, vm, exp, dir) => {\r\n    directiveHandlerFuncs[dir]?.(node, vm, exp);\r\n}\r\n\r\n// 导出指令对象，包含 model 和 if 指令的处理函数\r\nexport const directiveHandlerFuncs = {\r\n    /**\r\n     * 处理 model 指令，实现表单元素与视图模型数据的双向绑定\r\n     * @param {HTMLInputElement|HTMLSelectElement|HTMLTextAreaElement} node - 要处理的表单元素\r\n     * @param {object} vm - 视图模型实例\r\n     * @param {string} exp - 表达式，用于指定视图模型中的数据属性\r\n     */\r\n    model(node, vm, exp) {\r\n        // 调用 update 函数更新节点，传入节点、视图模型、表达式和指令类型\r\n        // update(node, vm, exp, 'model');\r\n        // 如果节点类型属于特殊类型，监听 change 事件\r\n        if (inputTypes.includes(node.type)) {\r\n            node.addEventListener('input', (e) => {\r\n                // 当输入事件触发时，将表单元素的当前值赋值给视图模型中的对应属性\r\n                vm[exp] = e.target.value;\r\n            });\r\n        } else if (specialTypes.includes(node.type)) {\r\n            console.log(node, vm, exp)\r\n            node.addEventListener('change', (e) => {\r\n                // 当事件触发时，将表单元素的 value 属性值赋值给视图模型中的对应属性\r\n                if (node.type === 'checkbox') {\r\n                    if (vm[exp].includes(e.target.getAttribute('value'))) {\r\n                        vm[exp].splice(vm[exp].indexOf(e.target.getAttribute('value')), 1);\r\n                    } else {\r\n                        vm[exp].push(e.target.getAttribute('value'));\r\n                    }\r\n                    vm[exp] = vm[exp].slice()\r\n                } else if (node.type === 'radio') {\r\n                    vm[exp] = e.target.value;\r\n                } else if (node.type === 'select') {\r\n                    vm[exp] = e.target.value;\r\n                }\r\n            });\r\n        }\r\n        // 如果节点类型为 text，监听 input 事件\r\n\r\n        // 处理不支持的输入类型，输出警告信息\r\n        else {\r\n            console.warn(`Unsupported input type: ${node.type}`);\r\n        }\r\n    },\r\n    /**\r\n     * 处理 if 指令，根据表达式的值决定节点的显示与隐藏\r\n     * @param {HTMLElement} node - 要处理的节点\r\n     * @param {object} vm - 视图模型实例\r\n     * @param {string} exp - 表达式，用于判断节点是否显示\r\n     */\r\n    if(node, vm, exp) {\r\n        node.parentNode.__if__ = node;\r\n    },\r\n    for(node, vm, exp) {\r\n        for (let i = 0; i < Number(exp); i++) {\r\n            node.parentNode.appendChild(node.cloneNode(true));\r\n        }\r\n    }\r\n}","// 依赖收集器\r\nclass Dep {\r\n    constructor() {\r\n        this.subs = [];\r\n    }\r\n\r\n    addSub(sub) {\r\n        this.subs.push(sub);\r\n    }\r\n\r\n    notify() {\r\n        this.subs.forEach(sub => sub.update());\r\n    }\r\n}\r\n\r\nDep.target = null;\r\n\r\nexport default Dep;","import Dep from './Dep.js';\r\n\r\nexport default class Watcher {\r\n    constructor(vm, expOrFn, cb) {\r\n        this.vm = vm;\r\n        this.expOrFn = expOrFn;\r\n        this.cb = cb;\r\n        this.value = this.get();\r\n    }\r\n\r\n    get() {\r\n        Dep.target = this;\r\n        const value = this.vm[this.expOrFn];\r\n        Dep.target = null;\r\n        return value;\r\n    }\r\n\r\n    update() {\r\n        console.log('update', this);\r\n        const oldValue = this.value;\r\n        this.value = this.vm[this.expOrFn];\r\n        this.cb.call(this.vm, this.value, oldValue);\r\n    }\r\n}\r\n;","// 该引用可能需要调整，Watcher.js 在 reactivity 目录下\r\nimport Watcher from '../reactivity/Watcher.js';\r\n\r\n/**\r\n * 更新节点内容并添加观察者\r\n * @param {Node} node - 要更新的节点\r\n * @param {object} vm - 视图模型实例\r\n * @param {string|function} exp - 表达式或更新函数\r\n * @param {string} dir - 指令类型\r\n * @param {string} [attr] - 属性名（可选）\r\n */\r\n// 此函数的作用是更新节点内容，并且为节点添加观察者\r\n// 当数据发生变化时，观察者会触发回调函数来更新节点\r\nexport function update(node, vm, exp, dir, attr) {\r\n    // 根据 exp 的类型确定更新函数\r\n    const updaterFn = updaters[`${dir}`];\r\n    if (updaterFn) {\r\n        // 调用更新函数更新节点内容\r\n        updaterFn(node, vm[exp], attr);\r\n        new Watcher(vm, exp, (value, oldValue) => {\r\n            console.log('更新了', oldValue, '=>', value);\r\n            // 数据变化时调用更新函数更新节点\r\n            updaterFn(node, value, attr);\r\n        });\r\n    }\r\n    // 创建一个新的观察者，当数据变化时触发回调更新节点\r\n}\r\n\r\n// 定义各种更新函数的对象\r\nconst updaters = {\r\n    /**\r\n     * 更新元素属性值\r\n     * @param {HTMLElement} node - 要更新的元素节点\r\n     * @param {any} value - 新的属性值\r\n     * @param {string} attr - 属性名\r\n     */\r\n    // 此函数用于更新元素的指定属性值\r\n    attribute(node, value, attr) {\r\n        // 调用元素的 setAttribute 方法设置属性值\r\n        node.setAttribute(attr, value || '');\r\n    },\r\n    /**\r\n     * 更新文本节点内容\r\n     * @param {Text} node - 要更新的文本节点\r\n     * @param {any} value - 新的文本内容\r\n     */\r\n    // 此函数用于更新文本节点的内容\r\n    text(node, value) {\r\n        // 设置文本节点的文本内容\r\n        node.textContent = value;\r\n    },\r\n    /**\r\n     * 更新表单元素的值\r\n     * @param {HTMLInputElement|HTMLSelectElement|HTMLTextAreaElement} node - 要更新的表单元素\r\n     * @param {any} value - 新的值\r\n     */\r\n    // 此函数用于更新表单元素的值\r\n    model(node, value) {\r\n        // 设置表单元素的值\r\n        // debugger\r\n        if (node.type === 'checkbox') {\r\n            node.checked = value.includes(node.value);\r\n        } else if (node.type === 'radio') {\r\n            node.checked = value === node.value;\r\n        } else {\r\n            node.value = value;\r\n        }\r\n    },\r\n    // 此函数用于根据条件显示或隐藏节点\r\n    if(node, value) {\r\n        if (value) {\r\n            node.parentNode.replaceChild(node.parentNode.__if__, node);\r\n        } else {\r\n            node.remove();\r\n        }\r\n    },\r\n    show(node, value) {\r\n        value ? node.style.display = '' : node.style.display = 'none';\r\n    }\r\n}\r\n","import { isDirective, isEventDirective, isAttributDirective } from '../directives/DirectiveUtils.js';\r\nimport { eventHandler } from '../events/EventBinder.js';\r\nimport { directiveHandler } from '../directives/DirectiveHandler.js';\r\nimport Binding from '../core/Binding.js';\r\nimport { update } from '../utils/Updater.js';\r\n/**\r\n * 将 DOM 元素转换为文档片段\r\n * @param {HTMLElement} el - 要转换的 DOM 元素\r\n * @returns {DocumentFragment} - 转换后的文档片段\r\n/**\r\n * 编译文档片段或 DOM 节点\r\n * @param {Node} el - 要编译的节点\r\n * @param {object} vm - 视图模型实例\r\n */\r\nexport function compilerNode(el, vm, methods, components) {\r\n    const childNodes = el.childNodes;\r\n\r\n    Array.from(childNodes).forEach(node => {\r\n        if (node.nodeType === 1) {\r\n            if (node.tagName.includes('-')) {\r\n                // console.log(node.tagName)\r\n                const comment = document.createComment('');\r\n                node.replaceWith(comment)\r\n                try {\r\n                    const component = node.tagName.toLowerCase();\r\n                    new Binding({ component: components[component], el: comment })\r\n\r\n                } catch (error) {\r\n                    console.log(error)\r\n                }\r\n            } else {\r\n                compileElement(node, vm, methods, components);\r\n\r\n            }\r\n        } else if (node.nodeType === 3) {\r\n            compileText(node, vm);\r\n        }\r\n        if (node.childNodes && node.childNodes.length) {\r\n            compilerNode(node, vm, methods, components);\r\n\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 编译元素节点，处理元素的属性\r\n * @param {HTMLElement} node - 要编译的元素节点\r\n * @param {object} vm - 视图模型实例\r\n */\r\nexport function compileElement(node, vm, methods) {\r\n\r\n    const attrs = node.attributes;\r\n    Array.from(attrs).forEach(attr => {\r\n        const attrName = attr.name;\r\n        const exp = attr.value;\r\n        const dir = attrName.substring(1);\r\n        if (isDirective(attrName)) {\r\n            directiveHandler(node, vm, exp, dir)\r\n            update(node, vm, exp, dir);\r\n        } else if (isAttributDirective(attrName)) {\r\n            update(node, vm, exp, 'attribute', dir);\r\n        } else if (isEventDirective(attrName)) {\r\n            eventHandler(node, vm, exp, dir, methods);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 编译文本节点，处理文本中的插值表达式\r\n * @param {Text} node - 要编译的文本节点\r\n * @param {object} vm - 视图模型实例\r\n */\r\nexport function compileText(node, vm) {\r\n    const reg = /\\{\\{(.*)\\}\\}/;\r\n    const text = node.textContent;\r\n    if (reg.test(text)) {\r\n        const exp = RegExp.$1.trim();\r\n        update(node, vm, exp, 'text');\r\n    }\r\n}","import { compilerNode } from '../nodes/NodeCompiler.js';\r\n\r\n/**\r\n * 构造函数，初始化编译器\r\n * @param {string|HTMLElement} el - 要编译的 DOM 元素或选择器\r\n * @param {object} vm - 视图模型实例\r\n */\r\nexport default function compile(template, vm, methods, components) {\r\n\r\n    // let $fragment = node2Fragment(el);\r\n    // debugger\r\n    compilerNode(template, vm, methods, components);\r\n\r\n    // el.appendChild(json);\r\n}\r\n","import Dep from '../reactivity/Dep.js';\r\n\r\nfunction defineReactive(obj, key, val) {\r\n    const dep = new Dep();\r\n    observe(val); // 递归处理嵌套对象\r\n    Object.defineProperty(obj, key, {\r\n        enumerable: true,\r\n        configurable: true,\r\n        get() {\r\n            if (Dep.target) {\r\n                dep.addSub(Dep.target);\r\n            }\r\n            return val;\r\n        },\r\n        set(newVal) {\r\n            if (newVal === val) {\r\n                return;\r\n            }\r\n            val = newVal;\r\n            dep.notify(); // 触发更新\r\n        }\r\n    });\r\n}\r\n\r\nfunction observe(data) {\r\n    if (!data || typeof data !== 'object') {\r\n        return;\r\n    }\r\n    Object.keys(data).forEach(key => {\r\n        defineReactive(data, key, data[key]);\r\n    });\r\n}\r\n\r\n// 假设 defineReactive 函数在 Vue.js 中，这里需要导入或者重新定义\r\n// 暂时先假设已经导入，实际使用时需要处理\r\n\r\nexport default observe;","\r\nconst parser = new DOMParser();\r\n\r\nexport default (template) => {\r\n    const doc = parser.parseFromString(`<body>${template}</body>`, 'text/html');\r\n    const body = doc.querySelector('body')\r\n    return {\r\n        template: body.querySelector('template')?.content,\r\n        script: body.querySelector('script'),\r\n        style: body.querySelector('style'),\r\n    }\r\n};\r\n","import DOMParser from '../nodes/htmlParse.js';\r\n\r\nexport function loadComponent(url) {\r\n    const result = syncXmlHttpRequest(url)\r\n    return DOMParser(result);\r\n}\r\n\r\nexport function syncXmlHttpRequest(url) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', url, false); // 第三个参数设为 false 表示同步请求\r\n    xhr.send(null);\r\n    if (xhr.status === 200) {\r\n        return xhr.responseText;\r\n    } else {\r\n        throw new Error(`请求失败，状态码: ${xhr.status}`);\r\n    }\r\n}\r\n","\r\nimport compile from './Compile.js';\r\nimport observe from './Observe.js';\r\nimport { loadComponent } from '../utils/get.js';\r\n\r\nexport default class Binding {\r\n    constructor({ component, el, props = {} }) {\r\n\r\n        if (!component) {\r\n            throw new Error('component is required');\r\n        }\r\n        if (typeof component === 'string') {\r\n            component = loadComponent(component)\r\n        }\r\n\r\n        const { script, template, style } = component\r\n        // 1. 获取的ES6代码是模\r\n        const es6ModuleCode = script.textContent;\r\n\r\n        // 2. 将代码转为blob URL（模拟模块文件）\r\n        const blob = new Blob([es6ModuleCode], { type: 'text/javascript' });\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // 3. 用动态import()加载该模块\r\n        import(url).then(module => {\r\n            document.body.append(style)\r\n            // console.log(module.default); // 输出 'ES6 Module'\r\n            const data = module.default.data || {};\r\n            const methods = module.default.methods || {};\r\n            const components = module.default.components || {};\r\n            Object.assign(this, props, data);\r\n            observe(this);\r\n            // this.data = data\r\n            compile(template, this, methods, components);\r\n            // 终于明白这里为什么是replace\r\n            el.replaceWith(template)\r\n        }).catch(err => {\r\n            console.error('加载模块失败', err);\r\n        });\r\n    }\r\n    onLoad() {\r\n\r\n    }\r\n};"],"names":["isAttributDirective","attr","indexOf","isDirective","isEventDirective","eventHandler","node","vm","exp","dir","methods","fn","addEventListener","bind","specialTypes","inputTypes","directiveHandler","directiveHandlerFuncs","model","includes","type","e","target","value","console","log","getAttribute","splice","push","slice","warn","if","parentNode","__if__","for","i","Number","appendChild","cloneNode","Dep","constructor","subs","addSub","sub","notify","forEach","update","Watcher","expOrFn","cb","get","oldValue","call","updaterFn","updaters","attribute","setAttribute","text","textContent","checked","replaceChild","remove","show","style","display","compilerNode","el","components","childNodes","Array","from","nodeType","tagName","comment","document","createComment","replaceWith","component","toLowerCase","Binding","error","compileElement","compileText","length","attrs","attributes","attrName","name","substring","reg","test","RegExp","$1","trim","compile","template","defineReactive","obj","key","val","dep","observe","Object","defineProperty","enumerable","configurable","set","newVal","data","keys","parser","DOMParser","doc","parseFromString","body","querySelector","content","script","loadComponent","url","result","syncXmlHttpRequest","xhr","XMLHttpRequest","open","send","status","responseText","Error","props","es6ModuleCode","blob","Blob","URL","createObjectURL","then","module","append","default","assign","catch","err","onLoad"],"mappings":"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"}